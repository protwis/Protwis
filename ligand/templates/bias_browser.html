{% extends "home/base.html" %}
{% load static %}
{% csrf_token %}

{% block addon_css %}
<link rel="stylesheet" href="{% static 'home/css/jquery.dataTables.min.css' %}" type="text/css" />
<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.css" />-->
<!-- <link rel="stylesheet" href="{% static 'home/css/construct_browser.css' %}" type="text/css" /> -->
<link rel="stylesheet" href="{% static 'home/css/yadcf_bootstrap_version.css' %}" type="text/css" />
<link rel="stylesheet" href="{% static 'home/css/select2.css' %}" type="text/css" />
<!-- <link rel="stylesheet" href="{% static 'home/css/signprot-multitabtable.css' %}" type="text/css" /> -->
<!-- configure radio buttons style -->
<style>
	.highlight_green {
		display: none;
		/* background-color: green; */
	}

	.highlight {
		display: none;
		/* background-color: red; */
	}

	.inuse,
	.ui-slider-range .inuse,
	.yadcf-filter-range-number-slider .inuse {
		border-color: yellow;
		border-width: initial;
	}
</style>

<style type="text/css">
	.dataTables_scrollHeadInner {
		margin-top: 20px;
	}

	table.dataTable thead th,
	table.dataTable tbody td {
		max-width: 65px;
		word-break: break-all;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
	}

	table.dataTable thead .sorting {
		background-position: right;
	}

	.select2-container select2-container-multi {
		width: 75%;
	}

	.select2-container-multi .select2-choices .select2-search-field input {
		max-width: 50px;
	}

	.yadcf-filter-wrapper {
		position: center;
		display: flex;
		white-space: nowrap;
		margin-top: 7px;
		width: 50% !important;
	}

	.yadcf-filter-wrapper-inner {
		white-space: normal;
	}

	.select2-results {
		background-color: white;
		border: gray;
		width: 150px !important;
	}

	.yadcf-filter-range {
		grid-auto-columns: auto;
		max-width: 50px !important;
		font-family: sans-serif;
		font-size: 80%;
		font-weight: bold;
		margin: auto;
		margin-top: 10%;
		min-width: 40px;
	}

	table.dataTable thead .sorting {
		background-image: none !important;
	}

	table.dataTable thead .sorting_desc {
		background-image: none !important;
	}

	table.dataTable thead .sorting_asc {
		background-image: none !important;
	}

	table.dataTable.compact tbody th,
	table.dataTable.compact tbody td {
		padding: 5px 10px 5px 0px !important;
		/* width: 0px; */
	}

	table.dataTable.compact thead th,
	table.dataTable.compact thead td {
		padding: 5px 10px 5px 0px;
		/* width: 0px; */
	}

	table.dataTable.compact thead tr.over_header th {
		border-bottom: 1px solid #ccc;
	}

	table.dataTable.compact thead th.leftborder {
		border-left: 1px solid;
	}

	table.dataTable.compact thead th.rightborder {
		border-right: 1px solid;
	}

	.yadcf-filter-range {
		max-width: 40px !important;
		font-family: sans-serif;
		font-size: 80%;
		font-weight: bold;
		min-width: 40px;
	}

	.clicked_button {
		background-color: rgb(215, 215, 215);
	}

	#overlay {
		top: 0px;
		position: absolute;
		background: #f8f8f8;
		/*border: 1px solid #333;*/
		-webkit-box-shadow: 5px 0 2px -2px #888;
		box-shadow: 5px 0 2px -2px #888;
	}

	.container {
		width: 90%;
		/* display:flex;
            flex-direction: column; */
	}

	.wrapper {
		overflow-x: scroll;
		overflow-y: hidden;
	}

	#overlay tbody tr {
		background-color: #f8f8f8;
	}

	#count_row th {
		font-size: 11px;
		text-align: center;
	}

	.switch-field label:hover {
		cursor: pointer;
		/* width: 100%; */
	}

	.switch-field input:checked+label {
		background-color: #337ab7;
		/* #a5dc86; */
		box-shadow: none;
	}

	.border-left {
		padding-left: 3px;
	}

	.switch-field label:first-of-type {
		border-radius: 4px 0 0 4px;

	}

	.switch-field label:last-of-type {
		border-radius: 0 4px 4px 0;
	}

	.name {
		width: 100px;
		text-overflow: ellipsis;
		cursor: pointer;
		word-break: break-all;
		overflow: hidden;
		white-space: nowrap;
	}

	.name:hover {
		overflow: visible;
		white-space: normal;

	}

	.toolbar_data_css {
		width: 250px;
		margin-right: auto;
		margin-left: 0px;
		/* border: 1px solid; */
		font-family: "Lucida Grande", Tahoma, Verdana, sans-serif;
		font-weight: normal;
		font-size: 120%;
		line-height: 1.625;
	}

	.toolbar_data_css.td {
		height: 15px;
		max-width: 150px;
		overflow: hidden;
		white-space: nowrap;
		text-overflow: ellipsis;
	}
</style>

{% endblock %}

{% block content %}
{% autoescape off %}

<div style='padding-top: 0px; font-size: 10px; white-space: nowrap; overflow-y:hidden;  width:100%;'>

	<a id="dlink" style="display:none;"></a>
	<div id="excel_table" style2="display:none;"></div>
	<table class="display compact text-nowrap" id='structures_scrollable' style="width: 100%">
		<thead id="headers">
			<tr class="header-spans">
				<th><span class="glyphicon glyphicon-info-sign" title="Click on this icon in a row for more details."></span></th>
				<th id="receptor" style="border-left: 1px solid black; text-align:left" colspan="5">
					Receptor</th>
				<th style="border-left: 1px solid black; text-align:left" colspan="5" style="">
					Ligands</th>
				<th id="pathways_effector" style="border-left: 1px solid black; text-align:left" colspan="5">
					Pathway rank order<br>(by &#916;Log(Emax/EC50)</th>
				<th id="pathways_measure" style="border-left: 1px solid black; text-align:left" colspan="5">
					Bias rank order:<br>Measured effector</th>
				<th id="delta_relative_transduction_coef" class="shade" style="border-left: 1px solid black; text-align:left" colspan="4">
					Operational model <br> &#916;&#916;(Tau/Ka)</th>
				<th id="lbf" class="shade" style="border-left: 1px solid black; text-align:left" colspan="4">
					Relative<br>activity<br>(&#916;&#916;Log(Emax/EC50))</th>
				<th id="delta_emax_ec50_part" class="shade" style="border-left: 1px solid black; text-align:left" colspan="5">
					Ligand &#916;(Tau/KA)</th>
				<th id="relative_transduction_coef" class="shade" style="border-left: 1px solid black; text-align:left" colspan="5">
					Ligand &#916;Log(Emax/EC50)</th>
				<th class="shade" id="activity" style="border-left: 1px solid black; text-align:left" colspan="5">
					Potency (pEC50 or<br>
					<font color="#FF0000">pIC50)</font>
				</th>
				<th id="emax" class="shade" style="border-left: 1px solid black; text-align:left" colspan="5">
					Emax (% of ref ligand)</th>
				<th id="mm1" style="border-left: 1px solid black; text-align:left" colspan="5">
					Measured molecule 1</th>
				<th id="mm2" style="border-left: 1px solid black; text-align:left" colspan="5">
					Measured molecule 2</th>
				<th id="bio" style="border-left: 1px solid black; text-align:left" colspan="5">
					Biological process</th>
				<th id="cell" style="border-left: 1px solid black; text-align:left" colspan="5">
					Cell line</th>
				<th id="time" style="border-left: 1px solid black; text-align:left" colspan="5">
					Time resolved</th>
				<th style="border-left: 1px solid black; text-align:left; overflow: hidden;
                          white-space: nowrap;
                          text-overflow: ellipsis;
                  max-width: 250px;" colspan="2">Reference</th>
				<!-- <th style="border-left: 1px solid black; text-align:left" colspan="4">reference</th> -->
			</tr>
			<tr class="table-filter-dropdown">
				<th></th>

				<th id="class_filter_select">Class</th>
				<th id="receptor_filter_select">Rec Fam</th>
				<th id="uniprot_filter_select">UniProt</th>
				<th id="iuphar_filter_select">IUPHAR</th>
				<th id="species_filter_select">Species</th>

				<th id="reference_ligand_filter_select">Reference<br>ligand</th>
				<th id="ligand_filter_select">Tested<br>ligand</th>
				<th id="vendor_quantity_filter_select">#Ven<br>dors</th>
				<th id="article_quantity_filter_select">#Arti<br>cles</th>
				<th id="labs_quantity_filter_select">#Labs<br></th>

				<th class="pathways" id="pathways_effector_p1_filter_select">P 1</th>
				<th class="pathways" id="pathways_effector_p2_filter_select">P 2</th>
				<th class="pathways" id="pathways_effector_p3_filter_select">P 3</th>
				<th class="pathways" id="pathways_effector_p4_filter_select">P 4</th>
				<th class="pathways" id="pathways_effector_p5_filter_select">P 5</th>

				<th class="pathways" id="pathways_measure_p1_filter_select">P 1</th>
				<th class="pathways" id="pathways_measure_p2_filter_select">P 2</th>
				<th class="pathways" id="pathways_measure_p3_filter_select">P 3</th>
				<th class="pathways" id="pathways_measure_p4_filter_select">P 4</th>
				<th class="pathways" id="pathways_measure_p5_filter_select">P 5</th>

				<th class="shade" id="opmodel_p2_p1_filter_select">P1 - P2</th>
				<th class="shade" id="opmodel_p3_p1_filter_select">P1 - P3</th>
				<th class="shade" id="opmodel_p4_p1_filter_select">P1 - P4</th>
				<th class="shade" id="opmodel_p5_p1_filter_select">P1 - P5</th>

				<th class="shade" id="lbf_p2_p1_filter_select">P1 - P2</th>
				<th class="shade" id="lbf_p3_p1_filter_select">P1 - P3</th>
				<th class="shade" id="lbf_p4_p1_filter_select">P1 - P4</th>
				<th class="shade" id="lbf_p5_p1_filter_select">P1 - P5</th>

				<th class="shade" id="delta_emax_ec50_part_p2_p1_filter_select">P 1</th>
				<th class="shade" id="delta_emax_ec50_part_p2_p1_filter_select">P 2</th>
				<th class="shade" id="delta_emax_ec50_part_p3_p1_filter_select">P 3</th>
				<th class="shade" id="delta_emax_ec50_part_p4_p1_filter_select">P 4</th>
				<th class="shade" id="delta_emax_ec50_part_p5_p1_filter_select">P 5</th>

				<th class="shade" id="relative_transduction_coef_p2_p1_filter_select">P 1</th>
				<th class="shade" id="relative_transduction_coef_p2_p1_filter_select">P 2</th>
				<th class="shade" id="relative_transduction_coef_p3_p1_filter_select">P 3</th>
				<th class="shade" id="relative_transduction_coef_p4_p1_filter_select">P 4</th>
				<th class="shade" id="relative_transduction_coef_p5_p1_filter_select">P 5</th>

				<th class="shade" id="activity_p1_filter_select">P 1</th>
				<th class="shade" id="activity_p2_filter_select">P 2</th>
				<th class="shade" id="activity_p3_filter_select">P 3</th>
				<th class="shade" id="activity_p4_filter_select">P 4</th>
				<th class="shade" id="activity_p5_filter_select">P 5</th>

				<th class="shade" id="emax_p1_filter_select">P 1</th>
				<th class="shade" id="emax_p2_filter_select">P 2</th>
				<th class="shade" id="emax_p3_filter_select">P 3</th>
				<th class="shade" id="emax_p4_filter_select">P 4</th>
				<th class="shade" id="emax_p5_filter_select">P 5</th>

				<th id="measured_molecule_p1_filter_select">P 1</th>
				<th id="measured_molecule_p2_filter_select">P 2</th>
				<th id="measured_molecule_p3_filter_select">P 3</th>
				<th id="measured_molecule_p4_filter_select">P 4</th>
				<th id="measured_molecule_p5_filter_select">P 5</th>

				<th id="measured_molecule2_p1_filter_select">P 1</th>
				<th id="measured_molecule2_p2_filter_select">P 2</th>
				<th id="measured_molecule2_p3_filter_select">P 3</th>
				<th id="measured_molecule2_p4_filter_select">P 4</th>
				<th id="measured_molecule2_p5_filter_select">P 5</th>

				<th id="bioprocess_p1_filter_select">P 1</th>
				<th id="bioprocess_p2_filter_select">P 2</th>
				<th id="bioprocess_p3_filter_select">P 3</th>
				<th id="bioprocess_p4_filter_select">P 4</th>
				<th id="bioprocess_p5_filter_select">P 5</th>

				<th id="cell_p1_filter_select">P 1</th>
				<th id="cell_p2_filter_select">P 2</th>
				<th id="cell_p3_filter_select">P 3</th>
				<th id="cell_p4_filter_select">P 4</th>
				<th id="cell_p5_filter_select">P 5</th>

				<th id="time_p1_filter_select">P 1</th>
				<th id="time_p2_filter_select">P 2</th>
				<th id="time_p3_filter_select">P 3</th>
				<th id="time_p4_filter_select">P 4</th>
				<th id="time_p5_filter_select">P 5</th>

				<th id="authors_filter_select" style="overflow: hidden;
                          white-space: nowrap;
                          text-overflow: ellipsis;
                          max-width: 100px;">Authors</th>
				<th id="doi_reference_filter_select">DOI/ <br>Reference</th>
				<!-- <th>PubChem CID</th>
				<th>PubChem SID</th>
				<th>other</th>
                <th>gpcrdb</th> -->
			</tr>
		</thead>
		<tbody id='structures_scrollable_body'>
			{%for e in data_test%}
			<tr>
				<td>
					<span style='display: none'> {{e.ligand.id}}</span>
					<a href="#">
						<span class="glyphicon glyphicon-info-sign" title="Click for more details" onclick="openPopup('experiment/{{e.id}}/detail', 'Detail View', window, 1500, 1000)"></span>
					</a>
				</td>

				<!-- s.protein_conformation.protein.parent.family.parent.parent.parent.shorter() -->
				<td title='{{e.receptor.family.parent.parent.parent.name}}' style="border-left: 1px solid black;">{{e.receptor.family.parent.parent.parent.short|default_if_none:""}}</td>
				<td title='{{e.receptor.family.parent}}'>{{e.receptor.family.parent.short}}</td>
				<td title='{{e.uniprot}}'>{{e.receptor.entry_short}}</td>
				<td title='{{e.IUPHAR}}'>{{e.receptor.name.split|first}}</td>
				<td title='{{e.receptor.species.common_name}}'>{{e.receptor.species.common_name}}</td>
				<!-- ligand -->
				<td title='{{e.reference_ligand}}' style="border-left: 1px solid black;">{{e.reference_ligand}}</td>
				<td title='{{e.ligand}}'><a href='/ligand/{{e.ligand.id}}/info' target='_blank'>{{e.ligand}}</a>
				</td>
				<td style="text-align:right">{{e.vendor_quantity}}</td>
				<td style="text-align:right">{{e.article_quantity}}</td>
				<td style="text-align:right">{{e.labs_quantity}}</td>
				<!-- pathways -->
				<td style="text-align:left" class="pathway">{{e.pathways_p1|default_if_none:""}}</td>
				<td style="text-align:left" class="pathway">{{e.pathways_p2|default_if_none:""}}</td>
				<td style="text-align:left" class="pathway">{{e.pathways_p3|default_if_none:""}}</td>
				<td style="text-align:left" class="pathway">{{e.pathways_p4|default_if_none:""}}</td>
				<td style="text-align:left" class="pathway">{{e.pathways_p5|default_if_none:""}}</td>
				<!-- Assay -->
				<td style="text-align:left" title='{{e.assay_p1}}'>{{e.assay_p1|default_if_none:e.molecule1_p1|default_if_none:'' }}</td>
				<td style="text-align:left" title='{{e.assay_p2}}'>{{e.assay_p2|default_if_none:e.molecule1_p2|default_if_none:'' }}</td>
				<td style="text-align:left" title='{{e.assay_p3}}'>{{e.assay_p3|default_if_none:e.molecule1_p3|default_if_none:'' }}</td>
				<td style="text-align:left" title='{{e.assay_p4}}'>{{e.assay_p4|default_if_none:e.molecule1_p4|default_if_none:'' }}</td>
				<td style="text-align:left" title='{{e.assay_p5}}'>{{e.assay_p5|default_if_none:e.molecule1_p5|default_if_none:'' }}</td>
				<!-- t factor -->
				<td style="text-align:right" class="shade" id="opmodel_p2_p1">{{e.delta_relative_transduction_coef_p2_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade" id="opmodel_p3_p1">{{e.delta_relative_transduction_coef_p3_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade" id="opmodel_p4_p1">{{e.delta_relative_transduction_coef_p4_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade" id="opmodel_p5_p1">{{e.delta_relative_transduction_coef_p5_p1|default_if_none:""}}</td>
				<!-- log bias facrtor <> id=""---->
				<td style="text-align:right" class="shade" id="lbf_p2_p1">{{e.lbf_p2_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade" id="lbf_p3_p1">{{e.lbf_p3_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade" id="lbf_p4_p1">{{e.lbf_p4_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade" id="lbf_p5_p1">{{e.lbf_p5_p1|default_if_none:""}}</td>
				<!-- T coefficient -->
				<td style="text-align:right" class="shade">{{e.relative_transduction_coef_p1|default_if_none:""}}</td>
				<td style="text-align:right" class="shade">{{e.relative_transduction_coef_p2|default_if_none:""}}</td>
				<td style="text-align:right" class="shade">{{e.relative_transduction_coef_p3|default_if_none:""}}</td>
				<td style="text-align:right" class="shade">{{e.relative_transduction_coef_p4|default_if_none:""}}</td>
				<td style="text-align:right" class="shade">{{e.relative_transduction_coef_p5|default_if_none:""}}</td>
				<!-- lbf_part -->
				<td style="text-align:right" title='{{e.lbf_part_p1}}'>{{e.delta_emax_ec50_part_p1|default_if_none:"" }}</td>
				<td style="text-align:right" title='{{e.lbf_part_p2}}'>{{e.delta_emax_ec50_part_p2|default_if_none:"" }}</td>
				<td style="text-align:right" title='{{e.lbf_part_p3}}'>{{e.delta_emax_ec50_part_p3|default_if_none:"" }}</td>
				<td style="text-align:right" title='{{e.lbf_part_p4}}'>{{e.delta_emax_ec50_part_p4|default_if_none:"" }}</td>
				<td style="text-align:right" title='{{e.lbf_part_p5}}'>{{e.delta_emax_ec50_part_p5|default_if_none:"" }}</td>
				<!-- potency -->
				{%if e.activity_p1 %}
				{%if e.standard_type_p1 == 'EC50' %}
				<td class="shade" style="text-align:right">{{e.activity_p1|default_if_none:""|floatformat:1}} </td>
				{%else%}
				<td class="shade" style="text-align:right">
					<font color="#FF0000">{{e.activity_p1|default_if_none:""|floatformat:1}} </font>
				</td>
				{%endif%}
				{%else%}
				<td class="shade">{{e.quality_activity_p1|default_if_none:""}}</td>
				{%endif%}

				{%if e.activity_p2 %}
				{%if e.standard_type_p2 == 'EC50' %}
				<td class="shade" style="text-align:right">{{e.activity_p2|default_if_none:""|floatformat:1}} </td>
				{%else%}
				<td class="shade" style="text-align:right">
					<font color="#FF0000">{{e.activity_p2|default_if_none:""|floatformat:1}} </font>
				</td>
				{%endif%}
				{%else%}
				<td class="shade">{{e.quality_activity_p2|default_if_none:""}}</td>
				{%endif%}

				{%if e.activity_p3 %}
				{%if e.standard_type_p3 == 'EC50' %}
				<td class="shade" style="text-align:right">{{e.activity_p3|default_if_none:""|floatformat:1}} </td>
				{%else%}
				<td class="shade" style="text-align:right">
					<font color="#FF0000">{{e.activity_p3|default_if_none:""|floatformat:1}} </font>
				</td>
				{%endif%}
				{%else%}
				<td class="shade">{{e.quality_activity_p3|default_if_none:""}}</td>
				{%endif%}

				{%if e.activity_p4 %}
				{%if e.standard_type_p4 == 'EC50' %}
				<td class="shade" style="text-align:right">{{e.activity_p4|default_if_none:""|floatformat:1}} </td>
				{%else%}
				<td class="shade" style="text-align:right">
					<font color="#FF0000">{{e.activity_p4|default_if_none:""|floatformat:1}} </font>
				</td>
				{%endif%}
				{%else%}
				<td class="shade">{{e.quality_activity_p4|default_if_none:""}}</td>
				{%endif%}

				{%if e.activity_p5 %}
				{%if e.standard_type_p5 == 'EC50' %}
				<td class="shade" style="text-align:right">{{e.activity_p5|default_if_none:""|floatformat:1}} </td>
				{%else%}
				<td class="shade" style="text-align:right">
					<font color="#FF0000">{{e.activity_p5|default_if_none:""|floatformat:1}} </font>
				</td>
				{%endif%}
				{%else%}
				<td class="shade">{{e.quality_activity_p5|default_if_none:""}}</td>
				{%endif%}

				<!-- E max -->
				<td style="text-align:right" class="shade">{{e.emax_p1|default_if_none:""|floatformat:0}}</td>
				<td style="text-align:right" class="shade">{{e.emax_p2|default_if_none:""|floatformat:0}}</td>
				<td style="text-align:right" class="shade">{{e.emax_p3|default_if_none:""|floatformat:0}}</td>
				<td style="text-align:right" class="shade">{{e.emax_p4|default_if_none:""|floatformat:0}}</td>
				<td style="text-align:right" class="shade">{{e.emax_p5|default_if_none:""|floatformat:0}}</td>

				<!-- Molecule 1 -->
				<td class="shade">{{e.molecule1_p1|default_if_none:""}}</td>
				<td class="shade">{{e.molecule1_p2|default_if_none:""}}</td>
				<td class="shade">{{e.molecule1_p3|default_if_none:""}}</td>
				<td class="shade">{{e.molecule1_p4|default_if_none:""}}</td>
				<td class="shade">{{e.molecule1_p5|default_if_none:""}}</td>
				<!-- Molecule 2 -->
				<td class="shade">{{e.molecule2_p1|default_if_none:""}}</td>
				<td class="shade">{{e.molecule2_p2|default_if_none:""}}</td>
				<td class="shade">{{e.molecule2_p3|default_if_none:""}}</td>
				<td class="shade">{{e.molecule2_p4|default_if_none:""}}</td>
				<td class="shade">{{e.molecule2_p5|default_if_none:""}}</td>
				<!-- Bioprocess -->
				<td title='{{e.measured_biological_process_p1}}'>{{e.measured_biological_process_p1|default_if_none:"" }}</td>
				<td title='{{e.measured_biological_process_p2}}'>{{e.measured_biological_process_p2|default_if_none:"" }}</td>
				<td title='{{e.measured_biological_process_p3}}'>{{e.measured_biological_process_p3|default_if_none:"" }}</td>
				<td title='{{e.measured_biological_process_p4}}'>{{e.measured_biological_process_p4|default_if_none:"" }}</td>
				<td title='{{e.measured_biological_process_p5}}'>{{e.measured_biological_process_p5|default_if_none:"" }}</td>
				<!-- Cell line -->
				<td title='{{e.cell_p1}}'>{{e.cell_p1|default_if_none:"" }}</td>
				<td title='{{e.cell_p2}}'>{{e.cell_p2|default_if_none:"" }}</td>
				<td title='{{e.cell_p3}}'>{{e.cell_p3|default_if_none:"" }}</td>
				<td title='{{e.cell_p4}}'>{{e.cell_p4|default_if_none:"" }}</td>
				<td title='{{e.cell_p5}}'>{{e.cell_p5|default_if_none:"" }}</td>

				<!-- Time resolved -->
				<td title='{{e.time_p1}}'>{{e.time_p1|default_if_none:"" }}</td>
				<td title='{{e.time_p2}}'>{{e.time_p2|default_if_none:"" }}</td>
				<td title='{{e.time_p3}}'>{{e.time_p3|default_if_none:"" }}</td>
				<td title='{{e.time_p4}}'>{{e.time_p4|default_if_none:"" }}</td>
				<td title='{{e.time_p5}}'>{{e.time_p5|default_if_none:"" }}</td>

				<!-- Reference -->
				<td class="name" style="border-left: 1px solid black;">
					{{e.publication.authors}}</td>
				<td class="name">
					<a href='{{e.publication.web_link}}' target='blank'>
						{{e.publication.web_link.index}}</a></td>


				<!-- {%if e.ligand_source_type == 'PubChem CID' %}
				<td>{{e.ligand_source_id|default_if_none:""}}</td>
				<td></td>
				<td></td>
				{%elif e.ligand_source_type == 'PubChem SID'%}
				<td></td>
				<td>{{e.ligand_source_id|default_if_none:""}}</td>
				<td></td>
				{%else%}
				<td></td>
				<td></td>
				<td>{{e.ligand_source_id|default_if_none:""}}</td>
				{%endif%}
                <td>{{e.ligand.id}}</td> -->
			</tr>
			{%endfor%}
		</tbody>


	</table>
</div>

<br>
{% endautoescape %}
<br>
{% endblock %}
{% block addon_js %}

<script src="{% static 'home/js/datatables.min.js' %}"> </script>
<script src="{% static 'home/js/jquery.dataTables.yadcf.js' %}"> </script>
<script src="{% static 'home/js/dataTables.buttons.min.js' %}"> </script>
<script src="{% static 'home/js/select2.js' %}"> </script>
<script src="{% static 'home/js/shading.js' %}"></script>
<script src="{% static 'home/js/signprot-multitabtable.js' %}"></script>

<script>
	$(document).ready(function() {
		function getCookie(name) {
			let cookieValue = null;
			if (document.cookie && document.cookie !== '') {
				const cookies = document.cookie.split(';');
				for (let i = 0; i < cookies.length; i++) {
					const cookie = cookies[i].trim();
					// Does this cookie string begin with the name we want?
					if (cookie.substring(0, name.length + 1) === (name + '=')) {
						cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
						break;
					}
				}
			}
			return cookieValue;
		}
		const csrftoken = getCookie('csrftoken');

		var table = $('#structures_scrollable').DataTable({
			stateSave: false,
			processing: true,
			deferRender: true,
			dom: 'B<>flrtip',
			paging: false,
			scrollY: '60vh',
			scrollX: 'TRUE',
			scrollCollapse: true,
			"deferRender": true,
			"lengthChange": false,
			order: [
				[28, "desc"]
			],
			'columnDefs': [
				//hide the second & fourth column
				{
					'visible': false,
					'targets': [13, 14, 15, 18, 19, 20, 23, 24, 27, 28, 31, 32, 33, 36, 37, 38, 41, 42, 43, 46, 47, 48, 51, 52, 53, 56, 57, 58, 61, 62, 63, 66, 67, 68, 71, 72, 73]
				}
			],
			"buttons": [{
					text: 'Export to Excel',
					className: 'btn btn-primary btn-sm',
					init: function(api, node, config) {
						$(node).removeClass('dt-button buttons-excel buttons-html5');
					},
					action: function(e, dt, node, config) {
						tableToExcel('structures_scrollable', 'Families data', 'GPCRDB.xls')
					},
				},
				{
					extend: 'csv',
					text: 'Export to CSV',
					className: 'btn btn-primary btn-sm',
					init: function(api, node, config) {
						$(node).removeClass('dt-button buttons-excel buttons-html5');
					},
					exportOptions: {
						modifier: {
							order: 'current',
							page: 'all',
							search: 'none'
						}
					}
				},
				{
					text: 'Get ligand vendors',
					className: 'btn btn-primary btn-sm',
					titleAttr: 'Vendors info for top 20 ligands',
					init: function(api, node, config) {
						$(node).removeClass('dt-button buttons-excel buttons-html5');
					},
					action: function(e, dt, node, config) {
						var id = read_ids()
						var result
						$.ajaxSetup({
							headers: {
								"X-CSRFToken": csrftoken
							}
						});
						$.ajax({
							type: 'POST',
							url: '/ligand/vendors',
							data: {
								ids: id,
								csrfmiddlewaretoken: '{{csrf_token }}',
								action: 'post',
							},
							success: function() {

								openPopup('/ligand/browservendors', 'Detail View', window, 850, 1000)
							}
						});
					},
				},
				{
					text: 'Show pathways',
					className: 'btn btn-primary btn-sm',
					init: function(api, node, config) {
						$(node).removeClass('dt-button buttons-excel buttons-html5');

					},
                    action: function(e, dt, node, config) {
                        resetHiddenColumns(table)
                    },
				},
				{
					text: 'Reset filters',
					className: 'btn btn-primary btn-sm',
					titleAttr: 'Reset All Filters',
					init: function(api, node, config) {
						$(node).removeClass('dt-button buttons-excel buttons-html5');
					},
					action: function(e, dt, node, config) {
						reset_filters()
					},
				},
			],

		});
		yadcf.init(table,
			[{
					column_number: 1,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Class",
					filter_reset_button_text: false,
				},
				{
					column_number: 2,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 3,
					filter_type: "multi_select",
					select_type: 'select2',
					//column_data_type: "html",
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 4,
					filter_type: "multi_select",
					select_type: 'select2',
					column_data_type: "rendered_html",
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 5,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				// Ligand
				{
					column_number: 6,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 7,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 8,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_plugin_options: {
						width: '30px'
					},
					filter_reset_button_text: false,
				},
				{
					column_number: 9,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_plugin_options: {
						width: '30px'
					},
					filter_reset_button_text: false,
				},
				{
					column_number: 10,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_plugin_options: {
						width: '30px'
					},
					filter_reset_button_text: false,
				},
				// pathway_bias
				{
					column_number: 11,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 12,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 13,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 14,
					select_type: 'select2',
					filter_type: "multi_select",
					text_data_delimiter: " ",
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 15,
					select_type: 'select2',
					filter_type: "multi_select",
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//pathways_subtype
				{
					column_number: 16,
					select_type: 'select2',
					filter_type: "multi_select",
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 17,
					select_type: 'select2',
					filter_type: "multi_select",
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 18,
					select_type: 'select2',
					filter_type: "multi_select",
					filter_default_label: "P 5",
					filter_reset_button_text: false,
				},
				{
					column_number: 19,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 20,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//op model
				{
					column_number: 21,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 22,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 23,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 24,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				//lbf
				{
					column_number: 25,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 26,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 27,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 28,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				//delta_emax_ec50
				{
					column_number: 29,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 30,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 31,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 32,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 33,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				//relative_transduction_coef
				{
					column_number: 34,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 35,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 36,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 37,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 38,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				//potency or ic50
				{
					column_number: 39,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 40,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 41,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 42,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 43,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				// Emax
				{
					column_number: 44,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 45,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 46,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 47,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				{
					column_number: 48,
					filter_type: "range_number",
					filter_default_label: ["Min", "Max"],
					filter_reset_button_text: false,
				},
				//measured_molecule p1
				{
					column_number: 49,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 50,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 51,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 52,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 53,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//mm2
				{
					column_number: 54,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 55,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 56,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 57,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,

				},
				{
					column_number: 58,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//bioprocess_p1_filter_select
				{
					column_number: 59,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 60,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 61,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 62,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 63,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//cell line
				{
					column_number: 64,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 65,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 66,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 67,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 68,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//time resovled
				{
					column_number: 69,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 70,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 71,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 72,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				{
					column_number: 73,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Select",
					filter_reset_button_text: false,
				},
				//Article
				{
					column_number: 74,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "Authors",
					filter_reset_button_text: false,
				},
				{
					column_number: 75,
					filter_type: "multi_select",
					select_type: 'select2',
					filter_default_label: "DOI",
					column_data_type: "html",
					html_data_type: "text",
					filter_reset_button_text: false,
				},
			], );

		function reset_filters() {
			yadcf.exResetAllFilters(table);
		}

		yadcf.exFilterColumn(table, [
			[25, {
				from: 1,
			}],
		]);
		$("#yadcf-filter--structures_scrollable-to-25").removeClass("inuse")

	});
</script>

<script type="text/javascript">
	function openPopup(url, title, win, w, h) {
		const y = win.top.outerHeight / 2 + win.top.screenY - (h / 2);
		const x = win.top.outerWidth / 2 + win.top.screenX - (w / 2);
		return win.open(url, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + w + ', height=' + h + ', top=' + y + ', left=' + x);
	}

	function read_ids() {
		var ids = [];
		var table = document.getElementById("structures_scrollable")
		var temp_lenght = table.rows.length;
		if (temp_lenght > 22) {
			temp_lenght = 22;
		}
		for (var i = 2; i < temp_lenght; i++) {
			var x = table.rows[i].cells[0];
			ids.push($(x).find('span:first')[0].innerText)
		}
		var myJSON = JSON.stringify(ids);
		return myJSON
	}

	function calculate_header() {
		var columnIds = [];
		var EmptyColumnIds = [];

		$("#pathways_effector").attr("colspan", 5);
		$("#pathways_measure").attr("colspan", 5);
		$("#opmodel").attr("colspan", 4);
		$("#delta_relative_transduction_coef").attr("colspan", 4);
		$("#lbf").attr("colspan", 5);
		$("#delta_emax_ec50_part").attr("colspan", 5);
		$("#relative_transduction_coef").attr("colspan", 5);
		$("#activity").attr("colspan", 5);
		$("#emax").attr("colspan", 5);
		$("#mm1").attr("colspan", 5);
		$("#mm2").attr("colspan", 5);
		$("#bio").attr("colspan", 5);
		$("#cell").attr("colspan", 5);
		$("#time").attr("colspan", 5);
		table.columns([16, 17]).visible(true);
	};
</script>
{% endblock %}
